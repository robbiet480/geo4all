This is untested, don't use it yet.